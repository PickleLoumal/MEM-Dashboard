{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "Automation Service Secrets Manager configuration for Perplexity AI and Google API credentials",
  "Parameters": {
    "EnvironmentName": {
      "Description": "Environment name prefix",
      "Type": "String",
      "Default": "mem-dashboard"
    },
    "PerplexityApiKey": {
      "Description": "Perplexity AI API key for Deep Research",
      "Type": "String",
      "NoEcho": true,
      "Default": "PLACEHOLDER_PERPLEXITY_API_KEY"
    },
    "GoogleServiceAccountJson": {
      "Description": "Google Service Account JSON (escaped, for Google Sheets access)",
      "Type": "String",
      "NoEcho": true,
      "Default": "PLACEHOLDER_SERVICE_ACCOUNT_JSON"
    },
    "GoogleOAuthCredentialsJson": {
      "Description": "Google OAuth 2.0 credentials JSON (escaped, for Google Drive access)",
      "Type": "String",
      "NoEcho": true,
      "Default": "PLACEHOLDER_OAUTH_CREDENTIALS_JSON"
    }
  },
  "Resources": {
    "AutomationGoogleCredentialsSecret": {
      "Type": "AWS::SecretsManager::Secret",
      "Properties": {
        "Name": "automation/google-credentials",
        "Description": "Google API credentials for automation services (Sheets and Drive)",
        "SecretString": {
          "Fn::Sub": "{\"service_account_json\": ${GoogleServiceAccountJson}, \"oauth_credentials_json\": ${GoogleOAuthCredentialsJson}}"
        },
        "Tags": [
          {"Key": "Project", "Value": {"Ref": "EnvironmentName"}},
          {"Key": "Component", "Value": "automation"},
          {"Key": "Environment", "Value": "production"}
        ]
      }
    }
  },
  "Outputs": {
    "GoogleCredentialsSecretArn": {
      "Description": "ARN of the Google credentials secret",
      "Value": {"Ref": "AutomationGoogleCredentialsSecret"},
      "Export": {"Name": {"Fn::Sub": "${EnvironmentName}-GoogleCredentialsSecretArn"}}
    },
    "GoogleCredentialsSecretName": {
      "Description": "Name of the Google credentials secret",
      "Value": "automation/google-credentials",
      "Export": {"Name": {"Fn::Sub": "${EnvironmentName}-GoogleCredentialsSecretName"}}
    }
  }
}
