{
  "family": "yfinance-diagnostic-task",
  "networkMode": "awsvpc",
  "requiresCompatibilities": ["FARGATE"],
  "cpu": "256",
  "memory": "512",
  "executionRoleArn": "arn:aws:iam::952189540759:role/ecsTaskExecutionRole",
  "taskRoleArn": "arn:aws:iam::952189540759:role/mem-dashboard-task-role",
  "containerDefinitions": [
    {
      "name": "diagnostic-container",
      "image": "952189540759.dkr.ecr.ap-east-1.amazonaws.com/mem-dashboard:20251030-yfinance-v2-fixed",
      "essential": true,
      "command": [
        "/bin/bash",
        "-c",
        "python3 -c \"import sys; import socket; import ssl; import urllib.request; from datetime import datetime; print('='*80); print('üîç yfinance ECS Diagnostics'); print('='*80); print(f'Time: {datetime.now()}'); print(f'Python: {sys.version}'); print(); print('1Ô∏è‚É£ Testing basic network...'); socket.create_connection(('www.google.com', 80), timeout=5); print('   ‚úÖ Internet: OK'); print(); print('2Ô∏è‚É£ Testing DNS...'); [print(f'   ‚úÖ {d} -> {socket.gethostbyname(d)}') for d in ['query1.finance.yahoo.com', 'finance.yahoo.com']]; print(); print('3Ô∏è‚É£ Testing HTTPS to Yahoo...'); urllib.request.urlopen('https://finance.yahoo.com', timeout=10); print('   ‚úÖ HTTPS: OK'); print(); print('4Ô∏è‚É£ Testing yfinance...'); import yfinance as yf; print(f'   ‚úÖ yfinance: {yf.__version__}'); print(); print('5Ô∏è‚É£ Testing stock data...'); symbols = ['000002.SZ', '601021.SS', 'AAPL']; [print(f'\\n   {s}:') or print(f'      History: {len(h)} days, Close: {h[\\\"Close\\\"].iloc[-1]:.2f}') if not (h := yf.Ticker(s).history(period='5d')).empty else print(f'      ‚ùå No data') for s in symbols]; print('\\n' + '='*80); print('üèÅ Complete'); print('='*80)\""
      ],
      "environment": [
        {
          "name": "AWS_DEFAULT_REGION",
          "value": "ap-east-1"
        }
      ],
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-group": "/ecs/yfinance-diagnostic",
          "awslogs-region": "ap-east-1",
          "awslogs-stream-prefix": "ecs"
        }
      }
    }
  ],
  "tags": [
    {
      "key": "Project",
      "value": "MEM-Dashboard"
    },
    {
      "key": "Purpose",
      "value": "yfinance-diagnostic"
    }
  ]
}

