# Environment Variables for AWS Deployment
# This file is sourced by deployment scripts

# AWS Configuration
export AWS_REGION="ap-east-1"
export AWS_ACCOUNT_ID="952189540759"

# Project Configuration
export PROJECT_NAME="mem-dashboard"
export ENVIRONMENT="production"
export DOCKER_IMAGE_TAG="latest"

# ECS Configuration
export ECS_CLUSTER_NAME="${PROJECT_NAME}-cluster"
export ECS_SERVICE_NAME="${PROJECT_NAME}-service"
export ECS_TASK_FAMILY="${PROJECT_NAME}-task"

# ECR Configuration
export ECR_REPOSITORY_NAME="${PROJECT_NAME}"
export ECR_REPOSITORY_URI="${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com/${PROJECT_NAME}"

# RDS Configuration
export RDS_INSTANCE_IDENTIFIER="${PROJECT_NAME}-db"
export RDS_INSTANCE_CLASS="db.t3.micro"
export RDS_ENGINE="postgres"
export RDS_ENGINE_VERSION="15.4"
export RDS_ALLOCATED_STORAGE="20"
export RDS_MAX_ALLOCATED_STORAGE="100"

# Network Configuration (ap-east-1)
export VPC_ID="vpc-06821bd95f90aed5b"
export VPC_CIDR="10.0.0.0/16"
export PUBLIC_SUBNET_1_CIDR="10.0.1.0/24"
export PUBLIC_SUBNET_2_CIDR="10.0.2.0/24"
export PRIVATE_SUBNET_1_CIDR="10.0.3.0/24"
export PRIVATE_SUBNET_2_CIDR="10.0.4.0/24"
export PRIVATE_SUBNET_A="subnet-0fa889f45ef57ccf2"
export PRIVATE_SUBNET_B="subnet-05496838fa2487bfc"

# Security Groups
export ECS_SECURITY_GROUP="sg-071e127bb3521821a"
export RDS_SECURITY_GROUP="sg-05468a10704715ec2"
export ALB_SECURITY_GROUP="sg-08f0b19558c64db33"

# Load Balancer Configuration
export ALB_NAME="${PROJECT_NAME}-alb"
export ALB_TARGET_GROUP_NAME="${PROJECT_NAME}-tg"
export ALB_LISTENER_PORT="80"
export ALB_TARGET_PORT="8000"
export ALB_DNS="mem-dashboard-alb-1995066194.ap-east-1.elb.amazonaws.com"

# =============================================================================
# Secrets Manager Configuration
# =============================================================================
export DB_SECRET_NAME="${PROJECT_NAME}/database"
export API_SECRET_NAME="${PROJECT_NAME}/api-keys"
export GOOGLE_CREDENTIALS_SECRET="automation/google-credentials"

# =============================================================================
# ElastiCache Redis Configuration (for Celery)
# =============================================================================
export REDIS_CLUSTER_NAME="${PROJECT_NAME}-redis"
export REDIS_SUBNET_GROUP="${PROJECT_NAME}-redis-subnet-group"
export REDIS_PARAMETER_GROUP="${PROJECT_NAME}-redis-params"
export REDIS_SECURITY_GROUP="${PROJECT_NAME}-redis-sg"
export REDIS_NODE_TYPE="cache.t3.micro"
export REDIS_ENGINE_VERSION="7.1"
export REDIS_PORT="6379"
# Set after cluster creation: export REDIS_ENDPOINT=""
# Set after cluster creation: export CELERY_BROKER_URL="redis://${REDIS_ENDPOINT}:${REDIS_PORT}/0"

# =============================================================================
# Automation Service Configuration
# =============================================================================
# Daily Briefing Stage 2 delay (seconds)
export DAILY_BRIEFING_STAGE2_DELAY="600"
# Google Sheets Spreadsheet ID
export GOOGLE_SHEETS_SPREADSHEET_ID="1cS4iSRck__DHXh1U7PfqfSmVxc_Aa_Tw2qbs35wI4i4"
# Google Drive Folder ID for reports
export GOOGLE_DRIVE_FOLDER_ID="1mBQd2ab-F_l4f51ltJXyWKzfAlJjJ54h"

# OAuth Token S3 Storage (for ECS/production)
# Token is stored in S3 because it needs to persist across container restarts
# and refresh automatically. The pickle file is read/written by google_drive.py
export OAUTH_TOKEN_S3_BUCKET="alfie-automation-config"
export OAUTH_TOKEN_S3_KEY="automation/oauth_token.pickle"

# Monitoring Configuration
export CLOUDWATCH_LOG_GROUP="/ecs/${PROJECT_NAME}"
export CLOUDWATCH_LOG_RETENTION_DAYS="7"

# Auto Scaling Configuration
export MIN_CAPACITY="1"
export MAX_CAPACITY="10"
export TARGET_CPU_UTILIZATION="70"

# Health Check Configuration
export HEALTH_CHECK_PATH="/api/health/"
export HEALTH_CHECK_INTERVAL="30"
export HEALTH_CHECK_TIMEOUT="5"
export HEALTH_CHECK_RETRIES="3"

# Tags
export TAG_PROJECT="${PROJECT_NAME}"
export TAG_ENVIRONMENT="${ENVIRONMENT}"
export TAG_OWNER="DevOps"
export TAG_COST_CENTER="Engineering"
